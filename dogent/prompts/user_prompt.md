User Request:
{user_message}

Attachments (JSON):
{attachments}

Todo Snapshot:
```markdown
{todo_block}
```

Guidance:
- Follow the system prompt.
- Ask for missing information before taking uncertain actions.
- Attachments are a JSON array; media entries may include a `vision` object with summaries/tags/text.
